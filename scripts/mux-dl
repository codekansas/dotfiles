#!/bin/sh

set -euo pipefail

if [ $# -lt 1 ]; then
  echo "Usage: $0 PLAYBACK_ID [OUTPUT_FILE]"
  exit 1
fi

PLAYBACK_ID="$1"
OUTPUT_FILE="${2:-video.mp4}"

URL="https://stream.mux.com/${PLAYBACK_ID}.m3u8"

echo "Downloading Mux playback ID: ${PLAYBACK_ID}"
echo "Saving to: ${OUTPUT_FILE}"
echo

ffmpeg -i "$URL" -c copy -progress pipe:1 -nostats "$OUTPUT_FILE"
